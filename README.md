# EV3 Performance Tests
Тесты производительности EV3 на разных языках программирования

## Методика тестирования
Тестирование проводилось по трём сценариям:
1. **Скорость обновления на холостом ходу**. Запускается цикл на 100000 итераций. По окончании работы цикла делим число итераций на время, чтобы получить скорость обновления на холостом ходу.
2. **Скорость чтения с датчика цвета EV3**. Режим работы датчика - Reflected. В цикле считываем показания с датчика и добавляем к аккумулятору. Считывание производим в течении 5 секунд. Получинное число итераций делим на 5.
3. **Скорость чтения уникальных значений с датчика цвета EV3**. Тест аналочен второму, но добавляется подсчёт уникальных значений: обновляем счётчик, если предыдущее значение с датчика отличается от нового. Датчик цвета во время тестирования постоянно перемещался между чёрным и белым цветом.
4. **П-регулятор по четырём сенсорам с двумя моторами**. Этот синтетический тест эмулирует нагрузку для соревнований "Движение по линии" или задачу с движением по линии и одновременным чтением легенды с помозью двух датчиков.

## Результаты
В таблицы дана частота в Гц - число итераций в секунду. Во всех столбцах больше - лучше. Результаты обновляются по мере проведения тестов. Сортировка результатов по числу уникальных чтений с датчика, так как именно этот параметр влияет в первую очередь на отзывчивость робота.
| Платформа       | Холостой ход | Чтение датчик | Уникальный датчик | Уникальный энкодер | П-регулятор |
| --------------- | ------------ | ------------- | ----------------- | ------------------ | ----------- |
| EV3RT           | n/a          | 178401        | 793               | 500                | 27193       |
| Clev3r          | 90826        | 10309         | 335               | 398/277            | 1460        |
| Ev3-G (LabView) | 6418         | 2025          | 331               | 370/242            | 403         |
| Classroom       | 6238         | 1769          | 334               | 318/156            | 350         |
| MicroPython     | 25687        | 4375          | 316               | 284/284            | 285         |
| evcpp           | n/a          | 44652         | 157               | -                  | -           |
| ev3-dc          | n/a          | 197           | 153               | -                  | -           |
| Ev3Dev Python   | 25867        | 447           | 132               | -                  | -           |

В папке images есть фотографии с результатами тестов.

## Комментарии

### [EV3RT](https://ev3rt-git.github.io)
Пока это самое быстрое решение для EV3, но порог вхождения самый высокий. Требуется долгая инициализация датчиков после запуска программы.

### [Clev3r](https://clev3r.ru/)
На текущий момент самое оптимальное решение для работы с EV3. Достаточно быстро, чтобы реализовывать стандартные алгоритмы спортивной робототехники. Достаточно просто, чтобы начать программировать на текстовом языке уже в начальной школе.

Скорость чтения уникальных значений энкодера отличается в зависимости от порта. Для A и B - близко к 400 Гц, для C и D - не дотягивает до 300 Гц. Поэтому реализовывать алгоритмы синхронизации на паре BC может быть проблематично.

### [EV3-G (LabView)](https://education.lego.com/en-au/downloads/retiredproducts/mindstorms-ev3-lab/software/)
Показал неплохие результаты в тесте с уникальными чтениями одного датчика. На П-регуляторе общая производительность заметно просела. Моторы B и C выдают значения энкодера с разной частотой.

### [Classroom](https://education.lego.com/en-au/downloads/mindstorms-ev3/software/)
В целом ситуация аналогична EV3-G, но производительность на тесте с П-регулятором ещё хуже.

### [MicroPython](https://education.lego.com/en-us/product-resources/mindstorms-ev3/teacher-resources/python-for-ev3/)
Показал неплохие результаты, сравнимые с Clev3r при работе с одним датчиком. Но на П-регуляторе результат оказался сильно хуже, чем у Clev3r.

Тем не менее, Python - перспективный язык, который пригодится и в школе. Для простых задач он хорошо подходит.

### evcpp
Чтобы установить, нужно искать evcpp в Visual Studio Code.

Частоту холостого хода напрямую измерить не удалось, так как компилятор оптимизирует программу и выбрасывает цикл.

### [ev3-dc](https://ev3-dc.readthedocs.io/)
Скрипт запускался на MacBook Air M1. Ожидаемо, на холостом ходу частота большая (10136800 Гц), но работа с устройствами EV3 медленная.

Фото с экрана EV3 нет, так как вывод осуществлялся на консоль ноутбука.

### [Ev3Dev Python](https://ev3dev-lang.readthedocs.io/projects/python-ev3dev)
Результаты хуже, чем у MicroPython, поэтому нет смылса использовать в настоящий момент.
